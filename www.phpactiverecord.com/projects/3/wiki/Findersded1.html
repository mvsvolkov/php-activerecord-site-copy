<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	
<!-- Mirrored from www.phpactiverecord.com/projects/3/wiki/Finders?version=8 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 May 2017 20:19:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
		<title>PHP ActiveRecord - Finders - An easy to use ORM for PHP</title>
		<link rel="canonical" href="http://www.phpactiverecord.org/projects/3/wiki/Finders"/>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="issue,bug,tracker" />
		<meta name="description" content="Redmine" />
		<meta name="googlebot" content="NOODP" />
		<meta name="robots" content="index,follow,noodp,noydir" />
		<link href="../../../stylesheets/blueprint/screen35c2.css?1366183229" media="screen" rel="stylesheet" type="text/css" />
		<link href="../../../stylesheets/blueprint/print35c2.css?1366183229" media="print" rel="stylesheet" type="text/css" />
		<!--[if lt IE 8]><link href="/stylesheets/blueprint/ie.css?1366183229" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
		<link href="../../../themes/basecamp/stylesheets/application3445.css?1366183196" media="screen" rel="stylesheet" type="text/css" />
		<link href="../../../stylesheets/jstoolbar35c2.css?1366183229" media="screen" rel="stylesheet" type="text/css" />
		<!--[if IE]>
		    <style type="text/css">
		      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
		      body {behavior: url(/stylesheets/csshover.htc?1366183229);}
		    </style>
		<![endif]-->
		
		<!-- page specific tags -->
		
  <link href="../../../stylesheets/scm35c2.css?1366183229" media="screen" rel="stylesheet" type="text/css" />
		<link href="../../../themes/basecamp/stylesheets/main3445.css?1366183196" media="screen" rel="stylesheet" type="text/css" />
	</head>
<body>
	
<div id="wrapper">
	<div id="header">
	    <div class="container">
	        <div class="span-7">
	            <h1><a href="http://www.phpactiverecord.org/" target="_top">php.activerecord</a></h1>
	        </div>
	        <div class="span-13" id="main-nav">
		        <ul class="horizontal"><li><a href="../../../download/index/main.html" class="download">Download</a></li>
<li><a href="../../main/wiki.html" class="guides">Wiki</a></li>
<li><a href="../../../docs/index/main.html" class="docs">Docs</a></li>
<li><a href="../../../news/index/mainddf6.html?project_id=main" class="news">News</a></li>
<li><a href="../../main/boards.html" class="boards">Forums</a></li>
<li><a href="../../../welcome/about/main.html" class="about-us">About us</a></li></ul>	        </div>
          <div class="span-4 last" id="account-menu">
		        <ul class="horizontal"><li><a href="../../../login.html" class="login">Sign in</a></li>
<li><a href="../../../account/register.html" class="register">Register</a></li></ul>          </div>
	    </div>
	</div>

	<div id="main-frame">
		<div id="breadcrumbs" class="container">
			<ul class="span-24 last">
				<li><a href="../../../index.html">Home</a></li><li><a href="../../main/wiki.html">Wiki</a></li><li class="last"><a href="../../main/wiki/Finders.html">Finders</a></li>
			</ul>
		</div>

		<div id="main" class="container">
			<div id="content" class="span-16 colborder">
				
				<div class="contextual">


<span id="watcher"></span>






<a href="Finders/history.html" class="icon icon-history">History</a>
</div>




    <p>    
    <a href="Finders17dd.html?version=7">&#171; Previous</a> - 
    Version 8/14
    (<a href="../../../wiki/3/Finders/diffded1.html?version=8">diff</a>) - 
    <a href="Finders29f9.html?version=9">Next &#187;</a> - 
    <a href="Finders.html">Current version</a>
    <br />
    <em>Kien La, 2010-06-19 05:54 PM </em><br />
    
    </p>
    <hr />


<div class="wiki">
  <h2 id="Finders">Finders<a href="#Finders" class="wiki-anchor">&para;</a></h2>


	<ul id="topic-list">
	<li><a href="../../main/wiki/Finders.html#single-record-result">Single record result</a></li>
		<li><a href="../../main/wiki/Finders.html#multiple-records-result">Multiple records result</a></li>
		<li><a href="../../main/wiki/Finders.html#finder-options">Finder options</a></li>
		<li><a href="../../main/wiki/Finders.html#conditions">Conditions</a></li>
		<li><a href="../../main/wiki/Finders.html#limit-offset">Limit &#38; Offset</a></li>
		<li><a href="../../main/wiki/Finders.html#order">Order</a></li>
		<li><a href="../../main/wiki/Finders.html#select">Select</a></li>
		<li><a href="../../main/wiki/Finders.html#from">From</a></li>
		<li><a href="../../main/wiki/Finders.html#group">Group</a></li>
		<li><a href="../../main/wiki/Finders.html#having">Having</a></li>
		<li><a href="../../main/wiki/Finders.html#read-only">Read only</a></li>
		<li><a href="../../main/wiki/Finders.html#dynamic-finders">Dynamic finders</a></li>
		<li><a href="../../main/wiki/Finders.html#joins">Joins</a></li>
		<li><a href="../../main/wiki/Finders.html#find-by-custom-sql">Find by custom SQL</a></li>
	</ul>


	<p>ActiveRecord supports a number of methods by which you can find records such as: via primary key, dynamic field name finders. It has the ability to fetch all the records in a table with a simple call, or you can make use of options like order, limit, select, and group.</p>


	<p>There are essentially two groups of finders you will be working with: <a href="../../main/wiki/Finders.html#single-record-result">a single record result</a> and <a href="../../main/wiki/Finders.html#multiple-records-result">multiple records result</a>. Sometimes there will be little transparency for the method calls, meaning you may use the same method to get either one, but you will pass an option to that method to signify which type of result you will fetch.</p>


	<p>All methods used to fetch records from your database will go through <strong>Model::find()</strong>, with one exception, custom sql can be passed to <a href="../../main/wiki/Finders.html#find-by-custom-sql">Model::find_by_sql()</a>. In all cases, the finder methods in ActiveRecord are statically invoked. This means you will always use the following type of syntax.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="r">class</span> <span class="cl">Book</span> <span class="r">extends</span> <span class="co">ActiveRecord</span>\<span class="co">Model</span> {}
<span class="no">2</span> 
<span class="no">3</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>);
<span class="no">4</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">last</span><span class="dl">'</span></span>);
<span class="no">5</span> <span class="co">Book</span>::first();
<span class="no">6</span> <span class="co">Book</span>::last();
<span class="no">7</span> <span class="co">Book</span>::all();
</span></code></pre>

	<h4 id="single-record-result">Single record result</h4>


	<p>Whenever you invoke a method which produces a single result, that method will return an instance of your model class. There are 3 different ways to fetch a single record result. We'll start with one of the most basic forms.</p>


	<h4>Find by primary key</h4>


	<p>You can grab a record by passing a primary key to the find method. You may pass an <a href="../../main/wiki/Finders.html#finder-options">options array</a> as the second argument for creating specific queries. If no record is found, a RecordNotFound exception will be thrown.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># Grab the book with the primary key of 2</span>
<span class="no">2</span> <span class="co">Book</span>::find(<span class="i">2</span>);
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE id = 2</span>
</span></code></pre>

	<h4>Find first</h4>


	<p>You can get the first record back from your database two ways. If you do not pass conditions as the second argument, then this method will fetch all the results from your database, but will only return the very first result back to you. Null will be returned if no records are found.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># Grab all books, but only return the first result back as your model object.</span>
<span class="no">2</span> <span class="lv">$book</span> = <span class="co">Book</span>::first();
<span class="no">3</span> <span class="pd">echo</span> <span class="s"><span class="dl">&quot;</span><span class="k">the first id is: </span><span class="il"><span class="dl">{</span><span class="lv">$book</span>-&gt;id<span class="dl">}</span></span><span class="dl">&quot;</span></span> <span class="c"># =&gt; the first id is: 1</span>
<span class="no">4</span> <span class="c"># sql =&gt; SELECT * FROM `books`</span>
<span class="no">5</span> 
<span class="no">6</span> <span class="c"># this produces the same sql/result as above</span>
<span class="no">7</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">first</span><span class="dl">'</span></span>);
</span></code></pre>

	<h4>Find last</h4>


	<p>If you haven't yet fallen asleep reading this guide, you should've guessed this is the same as "find first", except that it will return the last result. Null will be returned if no records are found.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># Grab all books, but only return the last result back as your model object.</span>
<span class="no">2</span> <span class="lv">$book</span> = <span class="co">Book</span>::last();
<span class="no">3</span> <span class="pd">echo</span> <span class="s"><span class="dl">&quot;</span><span class="k">the last id is: </span><span class="il"><span class="dl">{</span><span class="lv">$book</span>-&gt;id<span class="dl">}</span></span><span class="dl">&quot;</span></span> <span class="c"># =&gt; the last id is: 32</span>
<span class="no">4</span> <span class="c"># sql =&gt; SELECT * FROM `books`</span>
<span class="no">5</span> 
<span class="no">6</span> <span class="c"># this produces the same sql/result as above</span>
<span class="no">7</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">last</span><span class="dl">'</span></span>);
</span></code></pre>

	<h4 id="multiple-records-result">Multiple records result</h4>


	<p>This type of result will always return an array of model objects. If your table holds no records, or your query yields no results, then an empty array will be given.</p>


	<h4>Find by primary key</h4>


	<p>Just like the single record result for find by primary key, you can pass an array to the find method for multiple primary keys. Again, you may pass an <a href="../../main/wiki/Finders.html#finder-options">options array</a> as the last argument for creating specific queries. Every key which you use as an argument must produce a corresponding record, otherwise, a RecordNotFound exception will be thrown.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># Grab books with the primary key of 2 or 3</span>
<span class="no">2</span> <span class="co">Book</span>::find(<span class="i">2</span>,<span class="i">3</span>);
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE id IN (2,3)</span>
<span class="no">4</span> 
<span class="no">5</span> <span class="c"># same as above</span>
<span class="no">6</span> <span class="co">Book</span>::find(<span class="pd">array</span>(<span class="i">2</span>,<span class="i">3</span>));
</span></code></pre>

	<h4>Find all</h4>


	<p>There are 2 more ways which you can use to get multiple records back from your database. They use different methods; however, they are basically the same thing. If you do not pass an <a href="../../main/wiki/Finders.html#finder-options">options array</a>, then it will fetch all records.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># Grab all books from the database</span>
<span class="no">2</span> <span class="co">Book</span>::all();
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books`</span>
<span class="no">4</span> 
<span class="no">5</span> <span class="c"># same as above</span>
<span class="no">6</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>);
</span></code></pre>

	<p>Here we pass some options to the same method so that we don't fetch <strong>every</strong> record.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="lv">$options</span> = <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">limit</span><span class="dl">'</span></span> =&gt; <span class="i">2</span>);
<span class="no">2</span> <span class="co">Book</span>::all(<span class="lv">$options</span>);
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books` LIMIT 0,2</span>
<span class="no">4</span> 
<span class="no">5</span> <span class="c"># same as above</span>
<span class="no">6</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="lv">$options</span>);
</span></code></pre>

	<h4 id="finder-options">Finder options</h4>


	<p>There are a number of options available to pass to one of the finder methods for granularity. Let's start with one of the most important options: conditions.</p>


	<h4 id="conditions">Conditions</h4>


	<p>This is the "WHERE" of a SQL statement. By creating conditions, ActiveRecord will parse them into a corresponding "WHERE" SQL statement to filter out your results. Conditions can be extremely simple by only supplying a string. They can also be as complex as you'd like by creating a conditions string that uses ? marks as placeholders for values. Let's start with a simple example of a conditions string.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># fetch all the cheap books!</span>
<span class="no">2</span> <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">conditions</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">price &lt; 15.00</span><span class="dl">'</span></span>));
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE price &lt; 15.00</span>
<span class="no">4</span> 
<span class="no">5</span> <span class="c"># fetch all books that have &quot;war&quot; somewhere in the title</span>
<span class="no">6</span> <span class="co">Book</span>::find(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">conditions</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">title LIKE '%war%'</span><span class="dl">&quot;</span></span>));
<span class="no">7</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE title LIKE '%war%'</span>
</span></code></pre>

	<p>As stated, you can use *?* marks as placeholders for values which ActiveRecord will replace with your supplied values. The benefit of using this process is that ActiveRecord will escape your string in the backend with your database's native function to prevent SQL injection.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no"> 1</span> <span class="c"># fetch all the cheap books!</span>
<span class="no"> 2</span> <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">conditions</span><span class="dl">'</span></span> =&gt; <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">price &lt; ?</span><span class="dl">'</span></span>, <span class="fl">15.00</span>)));
<span class="no"> 3</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE price &lt; 15.00</span>
<span class="no"> 4</span> 
<span class="no"> 5</span> <span class="c"># fetch all lousy romance novels</span>
<span class="no"> 6</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">conditions</span><span class="dl">'</span></span> =&gt; <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">genre = ?</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">Romance</span><span class="dl">'</span></span>)));
<span class="no"> 7</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE genre = 'Romance'</span>
<span class="no"> 8</span> 
<span class="no"> 9</span> <span class="c"># fetch all books with these authors</span>
<span class="no"><strong>10</strong></span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">conditions</span><span class="dl">'</span></span> =&gt; <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">author_id in (?)</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="i">1</span>,<span class="i">2</span>,<span class="i">3</span>))));
<span class="no">11</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE author_id in (1,2,3)</span>
<span class="no">12</span> 
<span class="no">13</span> <span class="c"># fetch all lousy romance novels which are cheap</span>
<span class="no">14</span> <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">conditions</span><span class="dl">'</span></span> =&gt; <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">genre = ? AND price &lt; ?</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">Romance</span><span class="dl">'</span></span>, <span class="fl">15.00</span>)));
<span class="no">15</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE genre = 'Romance' AND price &lt; 15.00</span>
</span></code></pre>

	<p>Here is a more complicated example. Again, the first index of the conditions array are the condition strings. The values in the array after that are the values which replace their corresponding ? marks.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># fetch all cheap books by these authors</span>
<span class="no">2</span> <span class="lv">$cond</span> =<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">conditions</span><span class="dl">'</span></span>=&gt;<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">author_id in(?) AND price &lt; ?</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="i">1</span>,<span class="i">2</span>,<span class="i">3</span>), <span class="fl">15.00</span>));
<span class="no">3</span> <span class="co">Book</span>::all(<span class="lv">$cond</span>);
<span class="no">4</span> <span class="c"># sql =&gt; SELECT * FROM `books` WHERE author_id in(1,2,3) AND price &lt; 15.00</span>
</span></code></pre>

	<h4 id="limit-offset">Limit &#38; Offset</h4>


	<p>This one should be fairly obvious. A limit option will produce a SQL limit clause for supported databases. It can be used in conjunction with the <strong>offset</strong> option.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># fetch all but limit to 10 total books</span>
<span class="no">2</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">limit</span><span class="dl">'</span></span> =&gt; <span class="i">10</span>));
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books` LIMIT 0,10</span>
<span class="no">4</span> 
<span class="no">5</span> <span class="c"># fetch all but limit to 10 total books starting at the 6th book</span>
<span class="no">6</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">limit</span><span class="dl">'</span></span> =&gt; <span class="i">10</span>, <span class="s"><span class="dl">'</span><span class="k">offset</span><span class="dl">'</span></span> =&gt; <span class="i">5</span>));
<span class="no">7</span> <span class="c"># sql =&gt; SELECT * FROM `books` LIMIT 5,10</span>
</span></code></pre>

	<h4 id="order">Order</h4>


	<p>Produces an ORDERY BY SQL clause.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># order all books by title desc</span>
<span class="no">2</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">order</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">title desc</span><span class="dl">'</span></span>));
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books` ORDER BY title desc</span>
<span class="no">4</span> 
<span class="no">5</span> <span class="c"># order by most expensive and title</span>
<span class="no">6</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">order</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">price desc, title asc</span><span class="dl">'</span></span>));
<span class="no">7</span> <span class="c"># sql =&gt; SELECT * FROM `books` ORDER BY price desc, title asc</span>
</span></code></pre>

	<h4 id="select">Select</h4>


	<p>Passing a select key in your <a href="../../main/wiki/Finders.html#finder-options">options array</a> will allow you to specify which columns you want back from the database. This is helpful when you have a table with too many columns, but you might only want 3 columns back for 50 records. It is also helpful when used with a group statement.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># fetch all books, but only the id and title columns</span>
<span class="no">2</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">select</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">id, title</span><span class="dl">'</span></span>));
<span class="no">3</span> <span class="c"># sql =&gt; SELECT id, title FROM `books`</span>
<span class="no">4</span> 
<span class="no">5</span> <span class="c"># custom sql to feed some report</span>
<span class="no">6</span> <span class="co">Book</span>::find(<span class="s"><span class="dl">'</span><span class="k">all</span><span class="dl">'</span></span>, <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">select</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">avg(price) as avg_price, avg(tax) as avg_tax</span><span class="dl">'</span></span>));
<span class="no">7</span> <span class="c"># sql =&gt; SELECT avg(price) as avg_price, avg(tax) as avg_tax FROM `books` LIMIT 5,10</span>
</span></code></pre>

	<h4 id="from">From</h4>


	<p>This designates the table you are selecting from. This can come in handy if you do a <a href="../../main/wiki/Finders.html#joins">join</a> or require finer control.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># fetch the first book by aliasing the table name</span>
<span class="no">2</span> <span class="co">Book</span>::first(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">select</span><span class="dl">'</span></span>=&gt; <span class="s"><span class="dl">'</span><span class="k">b.*</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">from</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">books as b</span><span class="dl">'</span></span>));
<span class="no">3</span> <span class="c"># sql =&gt; SELECT b.* FROM books as b LIMIT 0,1</span>
</span></code></pre>

	<h4 id="group">Group</h4>


	<p>Generate a GROUP BY clause.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># group all books by prices</span>
<span class="no">2</span> <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">group</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">price</span><span class="dl">'</span></span>));
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books` GROUP BY price</span>
</span></code></pre>

	<h4 id="having">Having</h4>


	<p>Generate a HAVING clause to add conditions to your GROUP BY.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># group all books by prices greater than $45</span>
<span class="no">2</span> <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">group</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">price</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">having</span><span class="dl">'</span></span> =&gt; <span class="s"><span class="dl">'</span><span class="k">price &gt; 45.00</span><span class="dl">'</span></span>));
<span class="no">3</span> <span class="c"># sql =&gt; SELECT * FROM `books` GROUP BY price HAVING price &gt; 45.00</span>
</span></code></pre>

	<h4 id="read-only">Read only</h4>


	<p>Readonly models are just that: readonly. If you try to save a readonly model, then a ReadOnlyException will be thrown.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no"> 1</span> <span class="c"># specify the object is readonly and cannot be saved</span>
<span class="no"> 2</span> <span class="lv">$book</span> = <span class="co">Book</span>::first(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">readonly</span><span class="dl">'</span></span> =&gt; <span class="pc">true</span>));
<span class="no"> 3</span> 
<span class="no"> 4</span> <span class="r">try</span> {
<span class="no"> 5</span>   <span class="lv">$book</span>-&gt;save();
<span class="no"> 6</span> } <span class="r">catch</span> (<span class="co">ActiveRecord</span>\<span class="co">ReadOnlyException</span> <span class="lv">$e</span>) {
<span class="no"> 7</span>   <span class="pd">echo</span> <span class="lv">$e</span>-&gt;getMessage();
<span class="no"> 8</span>   <span class="c"># =&gt; Book::save() cannot be invoked because this model is set to read only</span>
<span class="no"> 9</span> }
</span></code></pre>

	<h4 id="dynamic-finders">Dynamic finders</h4>


	<p>These offer a quick and easy way to construct conditions without having to pass in a bloated array option. This option makes use of PHP 5.3's <a href="http://www.php.net/lsb" class="external">late static binding</a> combined with <a href="http://www.php.net/__callstatic" class="external">__callStatic()</a> allowing you to invoke undefined static methods on your model. You can either use YourModel::find_by which returns a <a href="../../main/wiki/Finders.html#single-record-result">single record result</a> and YourModel::find_all_by returns <a href="../../main/wiki/Finders.html#multiple-records-result">multiple records result</a>. All you have to do is add an underscore and another field name after either of those two methods. Let's take a look.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no"> 1</span> <span class="c"># find a single book by the title of War and Peace</span>
<span class="no"> 2</span> <span class="lv">$book</span> = <span class="co">Book</span>::find_by_title(<span class="s"><span class="dl">'</span><span class="k">War and Peace</span><span class="dl">'</span></span>);
<span class="no"> 3</span> <span class="c">#sql =&gt; SELECT * FROM `books` WHERE title = 'War and Peace'</span>
<span class="no"> 4</span> 
<span class="no"> 5</span> <span class="c"># find all discounted books</span>
<span class="no"> 6</span> <span class="lv">$book</span> = <span class="co">Book</span>::find_all_by_discounted(<span class="i">1</span>);
<span class="no"> 7</span> <span class="c">#sql =&gt; SELECT * FROM `books` WHERE discounted = 1</span>
<span class="no"> 8</span> 
<span class="no"> 9</span> <span class="c"># find all discounted books by given author</span>
<span class="no"><strong>10</strong></span> <span class="lv">$book</span> = <span class="co">Book</span>::find_all_by_discounted_and_author_id(<span class="i">1</span>, <span class="i">5</span>);
<span class="no">11</span> <span class="c">#sql =&gt; SELECT * FROM `books` WHERE discounted = 1 AND author_id = 5</span>
<span class="no">12</span> 
<span class="no">13</span> <span class="c"># find all discounted books or those which cost 5 bux</span>
<span class="no">14</span> <span class="lv">$book</span> = <span class="co">Book</span>::find_by_discounted_or_price(<span class="i">1</span>, <span class="fl">5.00</span>);
<span class="no">15</span> <span class="c">#sql =&gt; SELECT * FROM `books` WHERE discounted = 1 OR price = 5.00</span>
</span></code></pre>

	<h4 id="joins">Joins</h4>


	<p>A join option may be passed to specify SQL JOINS. There are two ways to produce a JOIN. You may pass custom SQL to perform a join as a simple string. By default, the joins option will not <a href="../../main/wiki/Finders.html#select">select</a> the attributes from the joined table; instead, it will only select the attributes from your model's table. You can pass a select option to specify the fields.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># fetch all books joining their corresponding authors</span>
<span class="no">2</span> <span class="lv">$join</span> = <span class="s"><span class="dl">'</span><span class="k">LEFT JOIN authors a ON(books.author_id = a.author_id)</span><span class="dl">'</span></span>;
<span class="no">3</span> <span class="lv">$book</span> = <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">joins</span><span class="dl">'</span></span> =&gt; <span class="lv">$join</span>));
<span class="no">4</span> <span class="c"># sql =&gt; SELECT `books`.* FROM `books`</span>
<span class="no">5</span> <span class="c">#      LEFT JOIN authors a ON(books.author_id = a.author_id)</span>
</span></code></pre>

	<p>Or, you may specify a join via an <a href="../../main/wiki/Associations.html">associated</a> model.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no"> 1</span> <span class="r">class</span> <span class="cl">Book</span> <span class="r">extends</span> <span class="co">ActiveRecord</span>\<span class="co">Model</span>
<span class="no"> 2</span> {
<span class="no"> 3</span>   <span class="r">static</span> <span class="lv">$belongs_to</span> = <span class="pd">array</span>(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">author</span><span class="dl">'</span></span>),<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">publisher</span><span class="dl">'</span></span>));
<span class="no"> 4</span> }
<span class="no"> 5</span> 
<span class="no"> 6</span> <span class="c"># fetch all books joining their corresponding author</span>
<span class="no"> 7</span> <span class="lv">$book</span> = <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">joins</span><span class="dl">'</span></span> =&gt; <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">author</span><span class="dl">'</span></span>)));
<span class="no"> 8</span> <span class="c"># sql =&gt; SELECT `books`.* FROM `books`</span>
<span class="no"> 9</span> <span class="c">#      INNER JOIN `authors` ON(`books`.author_id = `authors`.id)</span>
<span class="no"><strong>10</strong></span> 
<span class="no">11</span> <span class="c"># here's a compound join</span>
<span class="no">12</span> <span class="lv">$book</span> = <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">joins</span><span class="dl">'</span></span> =&gt; <span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">author</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">publisher</span><span class="dl">'</span></span>)));
<span class="no">13</span> <span class="c"># sql =&gt; SELECT `books`.* FROM `books`</span>
<span class="no">14</span> <span class="c">#      INNER JOIN `authors` ON(`books`.author_id = `authors`.id)</span>
<span class="no">15</span> <span class="c">#         INNER JOIN `publishers` ON(`books`.publisher_id = `publishers`.id)</span>
</span></code></pre>

	<p>Joins can be combined with strings and associated models.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no"> 1</span> <span class="r">class</span> <span class="cl">Book</span> <span class="r">extends</span> <span class="co">ActiveRecord</span>\<span class="co">Model</span>
<span class="no"> 2</span> {
<span class="no"> 3</span>   <span class="r">static</span> <span class="lv">$belongs_to</span> = <span class="pd">array</span>(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">publisher</span><span class="dl">'</span></span>));
<span class="no"> 4</span> }
<span class="no"> 5</span> 
<span class="no"> 6</span> <span class="lv">$join</span> = <span class="s"><span class="dl">'</span><span class="k">LEFT JOIN authors a ON(books.author_id = a.author_id)</span><span class="dl">'</span></span>;
<span class="no"> 7</span> <span class="c"># here we use our $join string and the association publisher</span>
<span class="no"> 8</span> <span class="lv">$book</span> = <span class="co">Book</span>::all(<span class="pd">array</span>(<span class="s"><span class="dl">'</span><span class="k">joins</span><span class="dl">'</span></span> =&gt; <span class="lv">$join</span>, <span class="s"><span class="dl">'</span><span class="k">publisher</span><span class="dl">'</span></span>));
<span class="no"> 9</span> <span class="c"># sql =&gt; SELECT `books`.* FROM `books`</span>
<span class="no"><strong>10</strong></span> <span class="c">#      LEFT JOIN authors a ON(books.author_id = a.author_id)</span>
<span class="no">11</span> <span class="c">#         INNER JOIN `publishers` ON(`books`.publisher_id = `publishers`.id)</span>
</span></code></pre>

	<h4 id="find-by-custom-sql">Find by custom SQL</h4>


	<p>If, for some reason, you need to create a complicated SQL query beyond the capacity of <a href="../../main/wiki/Finders.html#finder-options">finder options</a>, then you can pass a custom SQL query through Model::find_by_sql(). This will render your model as <a href="../../main/wiki/Finders.html#read-only">readonly</a> so that you cannot use any write methods on your returned model(s).</p>


	<p><strong>Caution:</strong> find_by_sql() will NOT prevent SQL injection like all other finder methods. The burden to secure your custom find_by_sql() query is on you.</p>


<pre class="code"><code class="php syntaxhl"><span class="CodeRay"><span class="no">1</span> <span class="c"># this will return a single result of a book model with only the title as an attirubte</span>
<span class="no">2</span> <span class="lv">$book</span> = <span class="co">Book</span>::find_by_sql(<span class="s"><span class="dl">'</span><span class="k">select title from `books`</span><span class="dl">'</span></span>);
<span class="no">3</span> 
<span class="no">4</span> <span class="c"># you can even select from another table</span>
<span class="no">5</span> <span class="lv">$cached_book</span> = <span class="co">Book</span>::find_by_sql(<span class="s"><span class="dl">'</span><span class="k">select * from books_cache</span><span class="dl">'</span></span>);
<span class="no">6</span> <span class="c"># this will give you the attributes from the books_cache table</span>
</span></code></pre>
</div>






<p class="other-formats">Also available in:
	<span><a href="Findersbbc2.html?format=html&amp;version=8" class="html" rel="nofollow">HTML</a></span>
	<span><a href="Finders53a7.html?format=txt&amp;version=8" class="txt" rel="nofollow">TXT</a></span>
</p>







				
			</div>

			<div id="sidebar" class="span-7 last">
				<div class="r-button" id="stable-build">
					<a href="../../../download.html">Get Stable Build - <em>v1.0</em><p>June 27 2010</p></a>
				</div>
				<div class="r-button" id="nightly-build">
					<a href="../../../download.html">Get Nightly Build <p>April 16, 2013</p></a>
				</div>
		
				

				<h2 id="news-header">
	<a href="../../../news.html">Latest News</a>
	<a class="feed" href="../../main/news.atom"><img src="../../../images/feed-icon-14x14.png"/></a>
</h2>

<ul id="news-summary" class="icon-list">
	
	<li class="article">
		<a href="../../../news/6-website-downtime.html">Website Downtime</a>
		
		<div class="meta">
			<em class="relative" title="2011-09-26T16:43:49Z">Mon Sep 26 12:43:49 -0400 2011</em> ago
			
		</div>
		
	</li>
	
	<li class="article">
		<a href="../../../news/5-did-you-know-php-ar-has-eager-loading.html">Did you know? PHP-AR has Eager Loading</a>
		
		<div class="meta">
			<em class="relative" title="2010-08-31T23:31:08Z">Tue Aug 31 19:31:08 -0400 2010</em> ago
			
		</div>
		
	</li>
	
	<li class="article">
		<a href="../../../news/4-php-activerecord-1-0-released.html">php-activerecord 1.0 released!</a>
		
		<div class="meta">
			<em class="relative" title="2010-06-28T00:02:55Z">Sun Jun 27 20:02:55 -0400 2010</em> ago
			
		</div>
		
	</li>
	
	<li class="article">
		<a href="../../../news/3-website-updated-with-forums-and-wiki.html">Website updated with forums and wiki</a>
		
		<div class="meta">
			<em class="relative" title="2010-06-18T21:37:23Z">Fri Jun 18 17:37:23 -0400 2010</em> ago
			
		</div>
		
	</li>
	
	<li class="article">
		<a href="../../../news/2-php-activerecord-1-0-rc1-released.html">php-activerecord 1.0 RC1 released!</a>
		
		<div class="meta">
			<em class="relative" title="2010-04-07T00:00:15Z">Tue Apr 06 20:00:15 -0400 2010</em> ago
			
		</div>
		
	</li>
	
</ul>




				<h2><a href="../../main/activity.html">Recent Activity</a></h2>
<ul id="recent-activity" class="icon-list">
		<li class="message">
	  
		<a href="http://www.phpactiverecord.com/boards/1/topics/2069-re-support-for-multi-row-inserts-and-insert-ignore">Encotrei uma solução alternativa para varias inserções.

Model::query(&#39;inse...</a>
		
		<div class="author">
			by <a href="../../../users/3231.html">renan henrique constancio</a>
			<em class="relative" title="2017-03-17T14:08:17Z">Fri Mar 17 10:08:17 -0400 2017</em>
		</div>
	</li>
		<li class="message">
	  
		<a href="http://www.phpactiverecord.com/boards/4/topics/2068-re-can-t-get-groupname-using-associations">I have the same question, have you find the answer?</a>
		
		<div class="author">
			by <a href="../../../users/3194.html">Israel Sousa</a>
			<em class="relative" title="2017-03-03T19:52:52Z">Fri Mar 03 14:52:52 -0500 2017</em>
		</div>
	</li>
		<li class="message">
	  
		<a href="http://www.phpactiverecord.com/boards/4/topics/2067-cannot-change-primary_key">Hi, 
I cannot change  $primary_key of entity.
After save is still in database o...</a>
		
		<div class="author">
			by <a href="../../../users/2785.html">Vasek Keberdle</a>
			<em class="relative" title="2017-01-03T17:20:13Z">Tue Jan 03 12:20:13 -0500 2017</em>
		</div>
	</li>
		<li class="message">
	  
		<a href="http://www.phpactiverecord.com/boards/4/topics/2066-re-saving-date-to-mysql-problem">That static property is not available anymore in stable build 1.0, so that won&#39;t ...</a>
		
		<div class="author">
			by <a href="../../../users/3038.html">Jos Faber</a>
			<em class="relative" title="2016-12-07T13:21:47Z">Wed Dec 07 08:21:47 -0500 2016</em>
		</div>
	</li>
		<li class="message">
	  
		<a href="http://www.phpactiverecord.com/boards/4/topics/2065-re-can-t-get-groupname-using-associations">Project is dead?</a>
		
		<div class="author">
			by <a href="../../../users/2948.html">McLotos McLotos</a>
			<em class="relative" title="2016-09-28T09:58:57Z">Wed Sep 28 05:58:57 -0400 2016</em>
		</div>
	</li>
		<li class="commit">
	  
		<a href="http://github.com/kla/php-activerecord/commit/96100175f2c268648a6b9fad3157620a6a6649d1">Merge pull request #284 from fetch/test-require-fix

Using __DIR__ in require_onc...</a>
		
		<div class="author">
			by <a href="../../../users/3.html">Jacques Fuentes</a>
			<em class="relative" title="2013-04-15T13:09:16Z">Mon Apr 15 09:09:16 -0400 2013</em>
		</div>
	</li>
		<li class="commit">
	  
		<a href="http://github.com/kla/php-activerecord/commit/f8220bfaaf820f53d99e3c97b97b4a5ee2a0adfe">absolute path require_once</a>
		
		<div class="author">
			by <a href="../../../users/1660.html">Koen Punt</a>
			<em class="relative" title="2013-04-15T08:07:39Z">Mon Apr 15 04:07:39 -0400 2013</em>
		</div>
	</li>
		<li class="commit">
	  
		<a href="http://github.com/kla/php-activerecord/commit/17eb9c6155ae3fb8ac144ab07ee828a19a8be9c1">Re #282, pointing phpunit at the tests...</a>
		
		<div class="author">
			by <a href="../../../users/show/David%20Rogers%20.html">David Rogers </a>
			<em class="relative" title="2013-04-11T20:39:30Z">Thu Apr 11 16:39:30 -0400 2013</em>
		</div>
	</li>
		<li class="commit">
	  
		<a href="http://github.com/kla/php-activerecord/commit/ec53c90187577c9671fd16a1a96979aed067b8cf">Driving tests with phpunit.xml re #282</a>
		
		<div class="author">
			by <a href="../../../users/show/David%20Rogers%20.html">David Rogers </a>
			<em class="relative" title="2013-04-11T20:26:29Z">Thu Apr 11 16:26:29 -0400 2013</em>
		</div>
	</li>
		<li class="commit">
	  
		<a href="http://github.com/kla/php-activerecord/commit/d8c90b6a640da93539ec0e758e60800fcee9bc8a">Create .travis.yml to drive Travis CI build</a>
		
		<div class="author">
			by <a href="../../../users/show/David%20Rogers%20.html">David Rogers </a>
			<em class="relative" title="2013-04-11T19:39:42Z">Thu Apr 11 15:39:42 -0400 2013</em>
		</div>
	</li>
	</ul>


				
  
<h3>Wiki</h3>

<a href="../wiki.html">Start page</a><br />
<a href="Page_index.html">Index by title</a><br />
<a href="Date_index.html">Index by date</a><br />


				
			</div>
		</div>
	</div>

	<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>

	<div id="footer">
	    <div class="container">
	        <div class="span-24 last">
			    <ul class="horizontal">
	<li><a href="../../../index.html">Home</a></li>
	<li><a href="../../../download/index/main.html">Download</a></li>
	<li><a href="../../main/wiki.html">Wiki</a></li>
	<li><a href="../../../docs.html">Documentation</a></li>
	<li><a href="http://github.com/kla/php-activerecord/issues">Issues</a></li
	<li><a href="../../../news.html">News</a></li>
	<li><a href="../../main/boards.html">Forums</a></li>
	<li class="last"><a href="../../../welcome/about.html">About Us</a></li>
</ul>
<p>
	<a href="http://www.phpactiverecord.org/" target="_top">phpactiverecord.org - An easy to use ORM for PHP</a><br/>
	<a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a>
</p>

	        </div>
	    </div>
	</div>
</div>


<script src="../../../assets/core35c2.js?1366183229" type="text/javascript"></script>


<script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script>
<script type="text/javascript">try { var pageTracker = _gat._getTracker("UA-10078176-1"); pageTracker._trackPageview();} catch(err) {}</script>



</body>

<!-- Mirrored from www.phpactiverecord.com/projects/3/wiki/Finders?version=8 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 May 2017 20:19:08 GMT -->
</html>
